"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveMember = void 0;
const discord_utilities_1 = require("@sapphire/discord-utilities");
require("../errors/Identifiers");
const Result_1 = require("../parsers/Result");
async function resolveMember(parameter, guild) {
    const member = (await resolveById(parameter, guild)) ?? (await resolveByQuery(parameter, guild));
    if (member)
        return (0, Result_1.ok)(member);
    return (0, Result_1.err)("memberError" /* ArgumentMemberError */);
}
exports.resolveMember = resolveMember;
async function resolveById(argument, guild) {
    const memberId = discord_utilities_1.UserOrMemberMentionRegex.exec(argument) ?? discord_utilities_1.SnowflakeRegex.exec(argument);
    return memberId ? guild.members.fetch(memberId[1]).catch(() => null) : null;
}
async function resolveByQuery(argument, guild) {
    argument = argument.length > 5 && argument.at(-5) === '#' ? argument.slice(0, -5) : argument;
    const members = await guild.members.fetch({ query: argument, limit: 1 }).catch(() => null);
    return members?.first() ?? null;
}
//# sourceMappingURL=member.js.map